---
import Layout from "../layouts/Layout.astro"
---

<!-- <script is:inline>
  const token = localStorage.getItem('token');

  console.log(token);

  if (!token) {
    window.location.href('/login');
  } else {
    fetch('http://localhost:3000/auth/profile', {
      method: 'GET',
      headers: { 'Authorization': `${token}` }
    })
    .then(response => response.json())
    .then(data => {
        document.querySelector('#profile').innerText = `Bienvenido ${data.user.username}`;
    })
    .catch(error => console.error('Error:', error));
}
</script> -->

<!-- <script is:inline>
  const token = localStorage.getItem('token');

  if (!token) {
    window.location.href = '/login'; // Redirigir si no hay token
  } else {
    fetch('/profile', {
      method: 'GET',
      headers: { 'Authorization': `Bearer ${token}` }
    })
    .then(response => {
      if (!response.ok) {
        // Si el servidor responde con un error, redirigir al usuario
        throw new Error('Token inválido o expirado');
      }
      return response.json();
    })
    .then(data => {
      if (data && data.user) {
        document.querySelector('#profile').innerText = `Bienvenido ${data.user.username}`;
      } else {
        document.querySelector('#profile').innerText = 'Error al cargar perfil';
      }
    })
    .catch(error => {
      console.error('Error:', error);
      window.location.href = '/login'; // Redirigir si el token es inválido
    });
  }
</script> -->

<Layout>
    <h2 id="profile">Esperando</h2>
</Layout>
